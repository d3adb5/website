<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="There comes a time in a technology enthusiast&rsquo;s life when they decide to build
a homelab. Chances are if you&rsquo;re reading this, you&rsquo;ve either googled the term
and know what I&rsquo;m talking about &mdash; so I promise not to take long in this
introduction &mdash; or you&rsquo;re following me (stalking much?) and don&rsquo;t necessarily
care.
In any case, I&rsquo;ve long had VPSes to host my personal projects and services
like Plex for myself and close friends. It&rsquo;s always seemed much cheaper than
purchasing the equipment and hosting on-premises. Recently I&rsquo;ve even set up a
Kubernetes cluster using k0s, a Kubernetes distribution made to be
simple and lightweight. Latency, bandwidth limits and weak hardware have
compelled me to build one instead."><meta http-equiv=Content-Security-Policy content="default-src 'self' cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src *; object-src 'none'; script-src 'self' 'unsafe-inline' cdn.jsdelivr.net; worker-src 'self' blob:; base-uri 'self'"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><title>Talos Linux Homelab Pt. 1: An introduction</title><link rel=preload as=font type=font/woff2 href=/fonts/source-sans-pro-regular.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/source-sans-pro-600.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/inconsolata-regular.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/inconsolata-600.woff2 crossorigin><style type=text/css>@font-face{font-display:swap;font-family:source sans pro;font-style:normal;font-weight:400;src:url(/fonts/source-sans-pro-regular.woff2)format("woff2"),url(/fonts/source-sans-pro-regular.woff)format("woff")}@font-face{font-display:swap;font-family:source sans pro;font-style:normal;font-weight:600;src:url(/fonts/source-sans-pro-600.woff2)format("woff2"),url(/fonts/source-sans-pro-600.woff)format("woff")}@font-face{font-display:swap;font-family:inconsolata;font-style:normal;font-weight:400;src:url(/fonts/inconsolata-regular.woff2)format("woff2"),url(/fonts/inconsolata-regular.woff)format("woff")}@font-face{font-display:swap;font-family:inconsolata;font-style:normal;font-weight:600;src:url(/fonts/inconsolata-600.woff2)format("woff2"),url(/fonts/inconsolata-600.woff)format("woff")}footer#page-footer,nav#site-nav{background:0 0;padding:1em}footer#page-footer,nav#site-nav{background:#282a2e;color:#c5c8c6;line-height:3em}nav#site-nav{display:flex;overflow:auto;scrollbar-width:none}nav#site-nav::-webkit-scrollbar{display:none}nav#site-nav a{display:inline-block;width:6em;font-weight:700;text-align:center;color:inherit;flex-shrink:0}@media screen and (min-width:60em){footer#page-footer,nav#site-nav{line-height:inherit}}html{background:#252628}body{width:100%;max-width:60em;margin:0 auto;line-height:1.5em;font-family:source sans pro,helvetica,liberation sans,open sans,sans-serif;font-size:100%;color:#c5c8c6}@media screen and (min-width:60em){body{margin:2em auto!important}}h1,h2,h3,h4,h5,h6{margin:1.1em 0 .83em}h1,h2,h3{color:#8c9440}h4,h5,h6{color:#b5bd68}h1{font-size:1.5em}h2{font-size:1.26em}h3{font-size:1.1em}h4{font-size:1.03em}h5{font-size:.67em}h6{font-size:.51em}a{text-decoration:initial;color:#de935f}a:hover{text-decoration:underline}em{color:#f0c674;font-style:normal}strong{color:#c66}nav#site-nav{border-radius:1em 1em 0 0;background:0 0;color:#c5c8c6}nav#site-nav a.push-right{margin-left:auto}nav#site-nav a.current{color:#81a2be}label#toc-toggle{display:flex;width:100%;margin-top:1em;height:3em;align-items:center;justify-content:center}input#toc-toggle-box{display:none}input#toc-toggle-box~nav#TableOfContents{display:none}input#toc-toggle-box:checked~nav#TableOfContents{display:block}nav#TableOfContents{margin:.5em 0 0;box-sizing:border-box;background:#282a2e;padding:1em;border-radius:.5em;overflow:hidden;font-weight:700;color:#de935f}nav#TableOfContents ul{margin:0;padding:0;list-style-type:none}nav#TableOfContents ul li{overflow:hidden;white-space:nowrap;text-overflow:' ...'}nav#TableOfContents ul li+li{margin-top:1em}nav#TableOfContents ul ul{padding-left:1em;margin-top:1em}@media screen and (min-width:60em){nav#TableOfContents{float:right;margin:1em 0 1em 1em;max-width:40%;font-size:85%}nav#TableOfContents ul li+li{margin-top:initial}nav#TableOfContents ul ul{margin-top:initial}}@media screen and (min-width:60em){label#toc-toggle{display:none}}@media screen and (min-width:60em){input#toc-toggle-box~nav#TableOfContents{display:initial}}footer#page-footer{background:0 0;color:#707880;display:grid;grid-auto-flow:column;grid-template-columns:minmax(0,1fr)}footer#page-footer a{color:#f0c674}footer#page-footer span.commit-subject{color:#de935f;margin-left:.5em}footer#page-footer p#commit{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}footer#page-footer p#commit span.commit-hash{font-family:inconsolata,dejavu sans mono,liberation mono,monospace}footer#page-footer p#timestamp,footer#page-footer p#commit{margin:0}footer#page-footer p#timestamp{text-align:right}article{background:#1d1f21;padding:.1em 1.5em .8em}@media screen and (min-width:60em){article{border-radius:.5em}}article header{font-weight:700}article header section.header-line{display:flex;justify-content:space-between;align-items:center}article header section.header-line h1{color:#8c9440;margin-bottom:.25em}article header section.header-line aside#translations{margin:1.1em 0 .25em}article header section.header-line aside#translations ul#translations{list-style:none;padding:0;margin:0;display:flex;justify-content:space-around;font-size:115%}article header section.header-line aside#translations ul#translations li:not(:first-child){margin-left:1em}article header section.subheader-line{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}article header section.subheader-line p.subtitle{color:#5e8d87;margin:0}article header section.subheader-line p.subtitle em{color:inherit;font-style:italic}article header section.subheader-line ul#article-tags{list-style-type:none;padding-left:0;margin:0;font-size:85%}article header section.subheader-line ul#article-tags li{display:inline-block}article header section.subheader-line ul#article-tags li:nth-child(n+2){margin-left:1em}article header section.subheader-line ul#article-tags li a{color:#f0c674}article blockquote{color:#979a98;padding-left:1em;border:0 solid #707880;border-left-width:.5em}article table{width:100%}article table th{color:#81a2be}article table td{color:#c5c8c6}article table td.date{width:1%;white-space:nowrap;padding:0 .5em 0 0}article table.compare-table{border-collapse:collapse}article table.compare-table th,article table.compare-table td{padding:.5em 1em;box-sizing:border-box}article table.compare-table th:first-child,article table.compare-table td:first-child{padding-left:0}article table.compare-table th:last-child,article table.compare-table td:last-child{padding-right:0}article table.compare-table th,article table.compare-table td:nth-child(n+2){text-align:center}article table.compare-table td{border-top:.1em solid #707880}article table.compare-table th:nth-child(n+2){min-width:4em}article li::marker{color:#f0c674}article figure{margin:1.25em 0;text-align:center}article figure img{min-height:5em;max-height:15em;width:100%;object-fit:cover;border-radius:1em}article figure figcaption p{margin-top:0}article code{font-family:inconsolata,dejavu sans mono,liberation mono,monospace;font-size:100%}article pre{background:#282a2e;border-radius:.5em;padding:.5em 1em;overflow-x:auto;line-height:initial}article>hr{color:#707880;opacity:.5;margin:2em 0}article p code,article li code{background:#282a2e;padding:0 .3em;border-radius:.25em}article>p a,article>ul li a,article>ol li a{text-decoration:underline}article.extra-pages h2~p{margin-left:2em}article section.dialog{display:flex;padding:1em;align-content:center;border-radius:.5em;border:.2em solid #707880;margin:.5em 0 0;box-sizing:border-box;max-width:100%}article section.dialog p:first-child{margin-top:0}article section.dialog p:last-child{margin-bottom:0}article section.dialog .dialog-icon{margin-right:1em}article section.dialog.dialog-info{border-color:#5f819d}article section.dialog.dialog-warning{border-color:#de935f}article section.dialog.dialog-error{border-color:#a54242}article section.dialog.dialog-success{border-color:#8c9440}@media screen and (min-width:60em){article section.dialog{margin:1em 0 0}}</style></head><body><nav id=site-nav><a href=/ class=[]>Home
</a><a href=/blog/ class=[]>Blog
</a><a href=/glob/ class=[]>Glob
</a><a href=/projects/ class=[]>Projects
</a><a href=/about/ class=push-right>About</a></nav><main role=main><article id=content><header><section class=header-line><h1>Talos Linux Homelab Pt. 1: An introduction</h1></section><section class=subheader-line><p class=subtitle>Yes, another on-premises cluster, what&rsquo;s new?</p><ul id=article-tags><li><a href=/tags/devops>DevOps</a></li><li><a href=/tags/homelab>Homelab</a></li><li><a href=/tags/kubernetes>Kubernetes</a></li><li><a href=/tags/talos>Talos</a></li><li><a href=/tags/technology>Technology</a></li></ul></section></header><p>There comes a time in a technology enthusiast&rsquo;s life when they decide to build
a homelab. Chances are if you&rsquo;re reading this, you&rsquo;ve either googled the term
and know what I&rsquo;m talking about &mdash; so I promise not to take long in this
introduction &mdash; or you&rsquo;re following me (stalking much?) and don&rsquo;t necessarily
care.</p><p>In any case, I&rsquo;ve long had <em>VPSes</em> to host my personal projects and services
like Plex for myself and close friends. It&rsquo;s always seemed much cheaper than
purchasing the equipment and hosting on-premises. Recently I&rsquo;ve even set up a
Kubernetes cluster using <a href=https://k0sproject.io/>k0s, a Kubernetes distribution</a> made to be
simple and lightweight. Latency, bandwidth limits and weak hardware have
compelled me to build one instead.</p><h2 id=hardware>Hardware</h2><p>I don&rsquo;t have the space for a server rack, nor the time to shop for enterprise
equipment bargains on Facebook Marketplace and similar platforms. Much less the
patience to deal with the noise and heat of server equipment. So since I
recently <a href=https://d3adb5.net/blog/building-a-computer/>upgraded my desktop from an <em>Optiplex 3080 Micro</em> to a custom
build,</a> I decided to repurpose it as my starting point.</p><p>The next step was to bargain hunt for small form factor PCs that could be used
to compose the cluster. I found a few <em>Lenovo Tiny M920q PCs</em> on Facebook
Marketplace for a good price, as well as an <em>Optiplex 7070 Micro</em> on sale by
another seller. I bought 3 of the Lenovo PCs, and that Optiplex, to have a
total of 5 nodes.</p><p>I bought a bigger shoe rack off Amazon and used the old one as a shelf for
these machines. Now I have something of a homelab corner:</p><figure><a href=/media/homelab-corner.webp><img src=/media/homelab-corner.webp alt="The homelab corner, between the new shoe rack and some boxes."></a><figcaption><p>The homelab corner, between the new shoe rack and some boxes.</p></figcaption></figure><p>It looks messy, I know, but I did my best. The lower shelf will hopefully be
populated by a NAS sometime in the next year. You might have noticed the Lenovo
computers each came with a DVD drive. <em>Isn&rsquo;t that refreshing?!</em></p><p>You might also notice there&rsquo;s a <em>network switch</em> above one of the Optiplex
computers in the picture above. That&rsquo;s a cheap NETGEAR GS108 switch I bought
off Amazon, alongside a 5-pack of CAT6 cables. I have no need for more than a
Gigabit, and these machines don&rsquo;t have 2.5GbE or 10GbE ports anyway, before you
ask. I had to buy a very long Ethernet cable to connect to the ISP&rsquo;s router,
too. I hope to get a better router in the future.</p><p>I have to say, hoooking up all these machines to the switch felt very
satisfying. Maybe it&rsquo;s the clicky sound of the RJ45 connectors, or the fact
that with every click another machine was added to the network. I don&rsquo;t know,
but it at least doesn&rsquo;t look too messy:</p><figure><a href=/media/homelab-network-wires.webp><img src=/media/homelab-network-wires.webp alt="The short, flat cables are actually quite nice to work with."></a><figcaption><p>The short, flat cables are actually quite nice to work with.</p></figcaption></figure><p>Lucky for me these guys, with one exception, all have the same CPU, an
<em>i5-8500T,</em> and 16 GB of RAM. The exception is my old Optiplex 3080, which has
a more powerful <em>i5-10500T</em> and 64 GB of RAM. I&rsquo;ll be using that one as the
sole control plane node, and hope that in the future I can find more of the
same model for cheap to make the control plane highly available.</p><h2 id=software>Software</h2><p>At first I thought I was going to reproduce the k0s installation I&rsquo;ve got on my
VPSes, and found that unfortunate. Going through the hassle of installing
something like Debian with an SSH daemon, then use roughly the same Ansible
playbooks? <strong>I&rsquo;d learn nothing new!</strong> At first I thought it was a good
opportunity to use <em>NixOS,</em> but then I stumbled upon <a href=https://talos.dev>Talos Linux</a>, a
Linux distribution built for Kubernetes that is <em>production ready.</em></p><p>Talos is one of those <em>immutable</em> distributions, and its machine configuration
is declarative, much like any other Kubernetes resource. It&rsquo;s got a
<em>convergence mechanism</em> in <code>talosctl</code>, and is mature enough that it is used in
production already. <em>So I went ahead and set it up!</em> This is what the Talos
dashboard looks like for the machine in the control plane currently:</p><figure><a href=/media/talos-dashboard-ottawa.webp><img src=/media/talos-dashboard-ottawa.webp alt="When the node is plugged into a display, this is what you&rsquo;ll see!"></a><figcaption><p>When the node is plugged into a display, this is what you&rsquo;ll see!</p></figcaption></figure><p>In the next part of this series of blogposts, I&rsquo;ll go through the process of
configuring the machines and setting up the cluster. If you want to go through
the files I&rsquo;m using, you can look at <a href=https://github.com/d3adb5/homelab>this repository on GitHub.</a></p></article></main><footer id=page-footer><p id=commit><a href=https://github.com/d3adb5/website/commit/62adb5aaae81a1cf4182c024beb144a603eeb1a3><span class=commit-hash>62adb5a</span><span class=commit-subject>content(blog): rename talos part 1 article</span></a></p><p id=timestamp>Updated October 8, 2024</p></footer></body></html>