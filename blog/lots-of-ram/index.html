<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="For the past couple of days I have been using a machine with 64 GB of RAM,
and 80 GB of swap space. This amount of computer memory is more than I have
ever conceived using. No, I&rsquo;m not gaming on it, and I&rsquo;m not a Java
developer running IntelliJ IDEA with 20+ projects open at the same time.
However, language servers and other applications I use on a daily basis have
made me rethink how much memory I really need."><meta http-equiv=Content-Security-Policy content="default-src 'self' cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src *; object-src 'none'; script-src 'self' 'unsafe-inline' cdn.jsdelivr.net; worker-src 'self' blob:; base-uri 'self'"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><title>Experiencing 64 GB of RAM + 80 GB of swap</title><link rel=preload as=font type=font/woff2 href=/fonts/source-sans-pro-regular.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/source-sans-pro-600.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/inconsolata-regular.woff2 crossorigin><link rel=preload as=font type=font/woff2 href=/fonts/inconsolata-600.woff2 crossorigin><style type=text/css>@font-face{font-display:swap;font-family:source sans pro;font-style:normal;font-weight:400;src:url(/fonts/source-sans-pro-regular.woff2)format("woff2"),url(/fonts/source-sans-pro-regular.woff)format("woff")}@font-face{font-display:swap;font-family:source sans pro;font-style:normal;font-weight:600;src:url(/fonts/source-sans-pro-600.woff2)format("woff2"),url(/fonts/source-sans-pro-600.woff)format("woff")}@font-face{font-display:swap;font-family:inconsolata;font-style:normal;font-weight:400;src:url(/fonts/inconsolata-regular.woff2)format("woff2"),url(/fonts/inconsolata-regular.woff)format("woff")}@font-face{font-display:swap;font-family:inconsolata;font-style:normal;font-weight:600;src:url(/fonts/inconsolata-600.woff2)format("woff2"),url(/fonts/inconsolata-600.woff)format("woff")}footer#page-footer,nav#site-nav{background:0 0;padding:1em}footer#page-footer,nav#site-nav{background:#282a2e;color:#c5c8c6;line-height:3em}nav#site-nav{display:flex;overflow:auto;scrollbar-width:none}nav#site-nav::-webkit-scrollbar{display:none}nav#site-nav a{display:inline-block;width:6em;font-weight:700;text-align:center;color:inherit;flex-shrink:0}@media screen and (min-width:60em){footer#page-footer,nav#site-nav{line-height:inherit}}html{background:#252628}body{width:100%;max-width:60em;margin:0 auto;line-height:1.5em;font-family:source sans pro,helvetica,liberation sans,open sans,sans-serif;font-size:100%;color:#c5c8c6}@media screen and (min-width:60em){body{margin:2em auto!important}}h1,h2,h3,h4,h5,h6{margin:1.1em 0 .83em}h1,h2,h3{color:#8c9440}h4,h5,h6{color:#b5bd68}h1{font-size:1.5em}h2{font-size:1.26em}h3{font-size:1.1em}h4{font-size:1.03em}h5{font-size:.67em}h6{font-size:.51em}a{text-decoration:initial;color:#de935f}a:hover{text-decoration:underline}em{color:#f0c674;font-style:normal}strong{color:#c66}nav#site-nav{border-radius:1em 1em 0 0;background:0 0;color:#c5c8c6}nav#site-nav a.push-right{margin-left:auto}nav#site-nav a.current{color:#81a2be}label#toc-toggle{display:flex;width:100%;margin-top:1em;height:3em;align-items:center;justify-content:center}input#toc-toggle-box{display:none}input#toc-toggle-box~nav#TableOfContents{display:none}input#toc-toggle-box:checked~nav#TableOfContents{display:block}nav#TableOfContents{margin:.5em 0 0;box-sizing:border-box;background:#282a2e;padding:1em;border-radius:.5em;overflow:hidden;font-weight:700;color:#de935f}nav#TableOfContents ul{margin:0;padding:0;list-style-type:none}nav#TableOfContents ul li{overflow:hidden;white-space:nowrap;text-overflow:' ...'}nav#TableOfContents ul li+li{margin-top:1em}nav#TableOfContents ul ul{padding-left:1em;margin-top:1em}@media screen and (min-width:60em){nav#TableOfContents{float:right;margin:1em 0 1em 1em;max-width:40%;font-size:85%}nav#TableOfContents ul li+li{margin-top:initial}nav#TableOfContents ul ul{margin-top:initial}}@media screen and (min-width:60em){label#toc-toggle{display:none}}@media screen and (min-width:60em){input#toc-toggle-box~nav#TableOfContents{display:initial}}footer#page-footer{background:0 0;color:#707880;display:grid;grid-auto-flow:column;grid-template-columns:minmax(0,1fr)}footer#page-footer a{color:#f0c674}footer#page-footer span.commit-subject{color:#de935f;margin-left:.5em}footer#page-footer p#commit{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}footer#page-footer p#commit span.commit-hash{font-family:inconsolata,dejavu sans mono,liberation mono,monospace}footer#page-footer p#timestamp,footer#page-footer p#commit{margin:0}footer#page-footer p#timestamp{text-align:right}article{background:#1d1f21;padding:.1em 1.5em .8em}@media screen and (min-width:60em){article{border-radius:.5em}}article header{font-weight:700}article header section.header-line{display:flex;justify-content:space-between;align-items:center}article header section.header-line h1{color:#8c9440;margin-bottom:.25em}article header section.header-line aside#translations{margin:1.1em 0 .25em}article header section.header-line aside#translations ul#translations{list-style:none;padding:0;margin:0;display:flex;justify-content:space-around;font-size:115%}article header section.header-line aside#translations ul#translations li:not(:first-child){margin-left:1em}article header section.subheader-line{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}article header section.subheader-line p.subtitle{color:#5e8d87;margin:0}article header section.subheader-line p.subtitle em{color:inherit;font-style:italic}article header section.subheader-line ul#article-tags{list-style-type:none;padding-left:0;margin:0;font-size:85%}article header section.subheader-line ul#article-tags li{display:inline-block}article header section.subheader-line ul#article-tags li:nth-child(n+2){margin-left:1em}article header section.subheader-line ul#article-tags li a{color:#f0c674}article blockquote{color:#979a98;padding-left:1em;border:0 solid #707880;border-left-width:.5em}article table{width:100%}article table th{color:#81a2be}article table td{color:#c5c8c6}article table td.date{width:1%;white-space:nowrap;padding:0 .5em 0 0}article table.compare-table{border-collapse:collapse}article table.compare-table th,article table.compare-table td{padding:.5em 1em;box-sizing:border-box}article table.compare-table th:first-child,article table.compare-table td:first-child{padding-left:0}article table.compare-table th:last-child,article table.compare-table td:last-child{padding-right:0}article table.compare-table th,article table.compare-table td:nth-child(n+2){text-align:center}article table.compare-table td{border-top:.1em solid #707880}article table.compare-table th:nth-child(n+2){min-width:4em}article li::marker{color:#f0c674}article figure{margin:1.25em 0;text-align:center}article figure img{min-height:5em;max-height:15em;width:100%;object-fit:cover;border-radius:1em}article figure figcaption p{margin-top:0}article code{font-family:inconsolata,dejavu sans mono,liberation mono,monospace;font-size:100%}article pre{background:#282a2e;border-radius:.5em;padding:.5em 1em;overflow-x:auto;line-height:initial}article>hr{color:#707880;opacity:.5;margin:2em 0}article p code,article li code{background:#282a2e;padding:0 .3em;border-radius:.25em}article>p a,article>ul li a,article>ol li a{text-decoration:underline}article.extra-pages h2~p{margin-left:2em}article section.dialog{display:flex;padding:1em;align-content:center;border-radius:.5em;border:.2em solid #707880;margin:.5em 0 0;box-sizing:border-box;max-width:100%}article section.dialog p:first-child{margin-top:0}article section.dialog p:last-child{margin-bottom:0}article section.dialog .dialog-icon{margin-right:1em}article section.dialog.dialog-info{border-color:#5f819d}article section.dialog.dialog-warning{border-color:#de935f}article section.dialog.dialog-error{border-color:#a54242}article section.dialog.dialog-success{border-color:#8c9440}@media screen and (min-width:60em){article section.dialog{margin:1em 0 0}}</style></head><body><nav id=site-nav><a href=/ class=[]>Home
</a><a href=/blog/ class=[]>Blog
</a><a href=/glob/ class=[]>Glob
</a><a href=/projects/ class=[]>Projects
</a><a href=/about/ class=push-right>About</a></nav><main role=main><article id=content><header><section class=header-line><h1>Experiencing 64 GB of RAM + 80 GB of swap</h1></section><section class=subheader-line><p class=subtitle>I am become Java, pursuer of RAM</p><ul id=article-tags><li><a href=/tags/hardware>Hardware</a></li><li><a href=/tags/novelty>Novelty</a></li><li><a href=/tags/technology>Technology</a></li></ul></section></header><p>For the past couple of days I have been using a machine with <em>64 GB of RAM,</em>
and <em>80 GB of swap space.</em> This amount of computer memory is more than I have
ever conceived using. No, <strong>I&rsquo;m not gaming on it,</strong> and I&rsquo;m not a Java
developer running IntelliJ IDEA with 20+ projects open at the same time.
However, language servers and other applications I use on a daily basis have
made me rethink how much memory I really need.</p><p>The swap space there is not really to allow me to run more programs at the same
time &mdash; they would be slowed down by the disk access anyway &mdash; but rather to
have it in case I need it. I do have two swap areas, setup as follows:</p><ul><li>16 GB of swap space on an NVMe SSD, <em>encrypted with a random key</em> at every
boot, with high priority for swap.</li><li>64 GB of swap space on a SATA SSD, encrypted with a fixed password, with low
priority for swap used for hibernation.</li></ul><p>The 16 GB of swap space on the NVMe SSD is the one actually meant to be used
should I start to run out of regular available memory. Meanwhile, the 64 GB of
encrypted swap on the SATA SSD was originally meant only for hibernation, but
since it would remain unused up until then, might as well put it to use should
my workloads really eat up all the memory.</p><h2 id=what-uses-so-much-memory-why-64-gb>What uses so much memory? Why 64 GB?</h2><p>Since the middle of 2022 I&rsquo;ve been using a <a href=/blog/using-a-micro-pc/>micro form factor PC</a>
called the Dell Optiplex 3080 Micro. Dell offers multiple configurations for
it, for storage, RAM, and CPU. You&rsquo;ll be paying a premium price no matter what,
but the cheapest will ship with <em>4 or 8 GB</em> of memory, a <em>256 GB SSD</em> for
storage, and a <em>Core i3-10300T</em> for the processor. The most expensive one, if
I&rsquo;m not mistaken, ships with a <em>Core i9-10900T.</em></p><p>The configuration I got came to me with <em>16 GB of RAM</em> &mdash; more than I had ever
had in any machine in my life &mdash; just <em>256 GB</em> for the SSD, and a <em>Core
i5-10500T,</em> which to this day impresses me with its performance. However, I&rsquo;m
guilty of running memory hungry applications all at the same time:</p><ul><li>Language servers to add functionality to Neovim through the LSP protocol.</li><li>Kubernetes clusters for testing and development, through <em>kind</em> and
<em>minikube.</em></li><li>Docker containers for testing and development, for things such as databases
or whatever I&rsquo;m working on.</li><li>Slack, Telegram Desktop, Whatsie, Google Messages, sometimes even Microsoft
Teams and Discord.</li><li>Multiple Firefox instances, both for personal use and for work.</li><li>Spotify or Tidal for music.</li></ul><p>The list goes on. Plenty of these are memory hungry only due to their use of
Electron, thus making each and every one of them isolated instances of Chromium
or whichever engine they use, which is <strong>tragic.</strong> No matter how much I try, I
cannot truly run away from this trend of shipping Electron and tons of
JavaScript in the name of &ldquo;cross-platform&rdquo; development. Maybe soon I&rsquo;ll get
tired of it and switch to opening new Firefox windows in other workspaces
instead.</p><h2 id=setting-up-encrypted-swap>Setting up encrypted swap</h2><p>To avoid leaving any unscrambled memory contents on the disk through swap or
hibernation, swap space should be encrypted. Previously, I setup a partition
for swap on the SSD through <code>cryptsetup luksFormat</code>, running <code>mkswap</code> on the
unlocked device afterwards. However, since the <em>new 16 GB swap area</em> will not
be used for hibernation, the information on that partition is of no consequence
to the system and may be discarded at boot.</p><p>For added security, then, I now make use of a systemd feature: an encrypted
swap partition mounted with dm-crypt in plain mode with a random key at every
boot. This is accomplished with the following <code>/etc/crypttab</code>:</p><pre tabindex=0><code># name  device          password      options
swap    PARTLABEL=swap  /dev/urandom  swap,discard,cipher=aes-xts-plain64,size=512
</code></pre><p>The <code>swap</code> option implies <code>plain</code>, and makes it so systemd runs <code>mkswap</code> after
unlocking the device in plain mode. Thus the mapped device is ready to be used
with <code>swapon</code>. Add to this an entry for the partition used for hibernation &mdash;
this one <em>will need a fixed password,</em> as its contents do matter at boot &mdash;
and then <code>/etc/fstab</code> becomes:</p><pre tabindex=0><code>/dev/mapper/swap    none swap discard,pri=32767 0 0
/dev/mapper/slumber none swap discard,pri=0     0 0
</code></pre><p>Note that the regular <code>swap</code> space there has a higher priority than the
partition used for hibernation. That way, during normal operation you have both
swap areas available to you, but the one on faster storage will be prioritized
over the slow one.</p><h2 id=upgrading-my-storage-drive>Upgrading my storage drive</h2><p>I took the opportunity to upgrade the original storage drive to a <a href="https://www.harddrivebenchmark.net/hdd.php?hdd=NVMe%20WD%20BLACK%20SN770%201TB&amp;id=30900">WD Black
SN770 1 TB NVMe SSD</a> &mdash; what a mouthful &mdash; from the <a href="https://www.harddrivebenchmark.net/hdd.php?hdd=IM2P33F3A+NVMe+ADATA+256GB&amp;id=27387">ADATA IM2P33F3A
256 GB NVMe SSD</a> that came with the computer. Not because I needed
a faster drive, but because I was in desperate need of more space thanks to
Docker and a couple VMs.</p><p>The <em>SN770</em> isn&rsquo;t the fastest drive out there, but it&rsquo;s much faster than the
ADATA that came with the system, fast enough for my needs, and on top of that
it&rsquo;s affordable, costing roughly 100 CAD. The SATA SSD I&rsquo;m using is a <em>Samsung
850 EVO 500 GB,</em> which I had previously been using on my <em>ThinkPad X220.</em> I
don&rsquo;t think I&rsquo;ll run out of space, but in the future I might get a 4 TB SATA
SSD for storage purposes, when prices are much lower than their NVMe
counterparts.</p></article></main><footer id=page-footer><p id=commit><a href=https://github.com/d3adb5/website/commit/538f1828a225229364fac663e3a9549e8db8e1d9><span class=commit-hash>538f182</span><span class=commit-subject>feat: add tags to existing blog posts</span></a></p><p id=timestamp>Updated May 14, 2023</p></footer></body></html>